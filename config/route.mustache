/**
 * This file is automatically generated from `/config/route.mustache`,
 * DO NOT modify this file directly.
 */

import module from './module';

module.config(/* @ngInject */($stateProvider, $locationProvider, $urlRouterProvider) => {
    const templates = {};

    function pageHandle(pageName, pageInfo, resolve) {
        templates[pageName] = pageInfo.template;
        resolve();
    }

    function lazyLoadPage(pageName) {
        return new Promise((resolve) => {
            switch (pageName) {
            {{#states}}
            case '{{name}}':
                require.ensure(['./{{name}}/index'], (require) => {
                    pageHandle(pageName, require('./{{name}}/index'), resolve);
                });
                break;
            {{/states}}
            default:
                break;
            }
        });
    }

    $stateProvider
{{#states}}
        .state('{{name}}', {
            url: '{{{url}}}',
            templateProvider() {
                return templates.{{name}} || 'fail to load template';
            },
            controller: '{{name}}Ctrl',
            resolve: { lazyLoad() { return lazyLoadPage('{{name}}'); } },
        })
{{/states}};

    /**
    * looks like futureState is not compatible with urlRouterProvider.otherwise
    */
    $urlRouterProvider.otherwise('/');

    // 启用 html5 history
    $locationProvider.html5Mode(true);
});
